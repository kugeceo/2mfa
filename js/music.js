var searchResultNum=-1;var enterFlag="true";var serachTips=null;var settings;if(localStorage.getItem("settings")){settings=JSON.parse(localStorage.getItem("settings"))}else{settings={"searchHistory":"false","searchTips":"close"}}function getSearchData(e){var c=$("#search-input");var d=$(".down-list");var b="";if(settings.searchTips=="baidu"){datas=e.s;if(datas.length>5){for(var a=0;a<5;a++){b+="<li>"+datas[a]+"</li>"}}else{for(var a=0;a<datas.length;a++){b+="<li>"+datas[a]+"</li>"}}}else{if(settings.searchTips=="haosou"){datas=e.result;if(datas.length>5){for(var a=0;a<5;a++){b+="<li>"+datas[a].word+"</li>"}}else{for(var a=0;a<datas.length;a++){b+="<li>"+datas[a].word+"</li>"}}}else{if(settings.searchTips=="bing"){datas=e.AS.Results[0].Suggests;if(datas.length>5){for(var a=0;a<5;a++){b+="<li>"+datas[a].Txt+"</li>"}}else{for(var a=0;a<datas.length;a++){b+="<li>"+datas[a].Txt+"</li>"}}}}}d.html(b).show()}(function(){var c;var e=$("#search-input");var j=$("#search-category").find("span");var i;var g=true;if(localStorage.getItem("history")){i=JSON.parse(localStorage.getItem("history"))}else{i=[]}var b=[{"tips":"音乐常使死亡迟延","websites":{name:[["网易云音乐","QQ 音乐","虾米音乐","echo 回声","喜马拉雅 FM","音悦台","5sing 原创"]],sites:[["http://music.163.com/#/search/m/?s=guanjian","http://y.qq.com/portal/search.html#searchid=1&remoteplace=txt.yqq.top&t=song&w=guanjian","http://www.xiami.com/search?key=guanjian&pos=1","http://www.app-echo.com/search/sound?keyword=guanjian&src=3","http://www.ximalaya.com/search/guanjian","http://so.yinyuetai.com/mv?keyword=guanjian","http://search.5sing.kugou.com/?keyword=guanjian"]]}}];j.on("click",function(){var n=$(this).attr("index");var w=b[n].tips;var q=localStorage;e.focus();q.prevcategory=n;e.attr("placeholder",w);$(this).addClass("active").siblings().removeClass("active");f(n);var u=$("#search-websites").find("span");var p="record"+n;if(q.getItem(p)){var r=JSON.parse(q.getItem(p))[1]}if(r){var t=$("#search-websites").find('span[sites="'+r+'"]');q.prevwebsites=t.attr("sites");q.prevwebname=t.attr("sitesname");t.addClass("active").siblings().removeClass("active")}else{var o=u.eq(0).attr("sites");var v=u.eq(0).attr("sitesname");var s=[v,o];q.setItem(p,JSON.stringify(s));q.prevwebsites=o;q.prevwebname=v;u.eq(0).addClass("active").siblings().removeClass("active")}});if(localStorage.prevcategory){j.eq(localStorage.prevcategory).trigger("click")}else{j.eq(0).trigger("click")}function f(n){var u=b[n].websites.name;var o=b[n].websites.sites;var t=u.length;var s="";var p=localStorage;for(var r=0;r<t;r++){for(var q=0;q<u[r].length;q++){s+="<span sitesName = "+u[r][q]+" sites="+o[r][q]+">"+u[r][q]+"</span>"}s+="</br>"}document.getElementById("search-websites").innerHTML=s;var v=$("#search-websites").find("span");v.off("click").on("click",function(){var y=$(this).attr("sites");var x=$(this).attr("sitesName");var z=[x,y];var w="record"+n;$(this).addClass("active").siblings().removeClass("active");c=e.val();p.setItem(w,JSON.stringify(z));p.prevwebsites=y;p.prevwebname=x;if(c==""){e.focus();e.attr("placeholder","音乐常使死亡迟延")}else{if(settings.searchHistory=="true"){a(c,x,y)}h(c,y)}});if(!localStorage.getItem("recordState")){v.eq(0).trigger("click");localStorage.setItem("recordState","start")}}function k(n){n=n.replace(/[^u0000-u00FF]/g,function(o){return escape(o).replace(/(%u)(w{4})/gi,"&#x$2;")});return n}function h(r,o){var n=o;var p=r;var q=/BIANMA/g;if(q.test(n)){p=k(r);n=n.replace("BIANMA","");n=n.replace("guanjian",p);window.open(n)}else{n=n.replace("guanjian",p);window.open(n)}}function m(){$(document).on("keydown",function(p){var o=e.val();var n=localStorage;if(enterFlag=="true"){if(p.keyCode=="13"){if(o==""){e.attr("placeholder","音乐常使死亡迟延")}else{h(o,n.prevwebsites);if($(".down-list").find("li")){$(".down-list").find("li").hide()}if(settings.searchHistory=="true"){a(o,n.prevwebname,n.prevwebsites)}}}}})}function a(q,p,o){var r=n(q,p,o);if(t(q)){s(q)}else{if(i.length==5){i.splice(4,1);i.unshift(r)}else{i.unshift(r)}}localStorage.history=JSON.stringify(i);d();function n(w,v,u){return{"keywords":w,"sitename":v,"website":u}}function t(u){for(var v=0;v<i.length;v++){if(u==i[v]["keywords"]){return true}}}function s(u){for(var v=0;v<i.length;v++){if(u==i[v]["keywords"]){i.splice(v,1);i.unshift(r)}}}}function d(){if(localStorage.getItem("history")){var o="";var p=$(".history-list")[0];for(var n=0;n<i.length;n++){o+="<li>"+'<span class="search-words" arrayIndex="'+n+'">'+i[n]["keywords"]+"</span>"+'<span class="close"></span>'+'<a class="search-link" href="'+i[n]["website"]+'">'+i[n]["sitename"]+"</a>"+"</li>"}o=o+'<li class="clear-container">'+'<span class="clear-words">清空历史</span>'+"</li>";p.innerHTML=o}}function l(){localStorage.removeItem("history");i=[];$("#search-input").val("").focus()}showSearchHistory();m();keyUpEvent()})();